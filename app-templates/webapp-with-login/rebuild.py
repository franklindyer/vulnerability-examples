import sqlite3
import random
import string
import os
import wikipedia
import hashlib, uuid

def random_password():
    return ''.join(random.choice(string.ascii_lowercase) for i in range(20))

def random_salt():
    return os.urandom(32)

try:
    os.remove("accounts.db")
except OSError:
    pass

con = sqlite3.connect("accounts.db")
cur = con.cursor()

cur.execute("CREATE TABLE users (username TEXT NOT NULL, password BLOB NOT NULL, salt BLOB NOT NULL, secret TEXT);")

names = ["alice", "bob", "charlie", "diedre", "ennis", "faye", "gilberto", "honeyboo", "iggy", "jackie"]
for i in range(10):
    user = names[i] + str(random.randint(1000, 9999))
    passwd = random_password()
    if i < 1:
        print(f"You can use the username {user} with password {passwd}.")

    salt = random_salt()
    hpasswd = hashlib.pbkdf2_hmac('sha256', passwd.encode('utf-8'), salt, 20)
    secret_page = wikipedia.random(1)
    cur.execute("INSERT INTO users (username, password, salt, secret) VALUES (?, ?, ?, ?);", (user, hpasswd, salt, secret_page,))

con.commit()
con.close()
