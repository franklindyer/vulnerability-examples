from flask import Flask, render_template, request
import sqlite3
import wikipedia
import hashlib
from selectedLoginApp import *
from selectedDatabaseManager import *

dbman = SelectedLoginDatabaseManager("accounts.db")
loginapp = SelectedLoginApp(dbman)
app = Flask(__name__)

@app.route('/')
def index():
    return render_template("index.html")

@app.route('/login', methods=['POST'])
def login_page():
    user = request.form["username"]
    passwd = request.form["password"]

    login_res = loginapp.is_login(user, passwd)
    if login_res[0] == False:
        return "Invalid credentials."

    secret_info = wikipedia.page(login_res[1]).summary
    return render_template("homepage.html", user=user, secret=secret_info)


app.run(host='0.0.0.0')
